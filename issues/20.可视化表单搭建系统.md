最近着手研究做一个可视化表单搭建系统，可视化搭建简单来说主要使用 vue-draggable 来做拖拽，生成一套 JSON 数据，然后表单引擎要做的就是解析这套 JSON 数据，渲染成表单，然后还有属性配置面板，可以对表单组件属性进行配置（即对 JSON 数据进行修改）。

核心技术点，拖拽元素生成 JSON 数据，可支持嵌套布局，JSON 数据渲染其实就是使用了 vue 的动态组件功能，每个拖拽过来的数据里有组件的名称字段，根据动态组件 component 生成对应的组件并挂载上所有的属性。

核心代码：

```html
<component :is="componentName" v-bind="componentProp"></component>
```

页面布局

```html
<div>
  <div>组件列表</div>
  <div>渲染面板</div>
  <div>属性面板</div>
</div>
```

真的核心只有这一行，其他的工作都是修改 JSON 配置文件，从左侧的组件面板拖来一个组件，逻辑就是在配置文件中添加一项配置；在右侧属性修改面板中对属性进行修改，逻辑就是修改该组件配置项的某一项配置属性值；对配置 JSON 做出修改后，渲染面板会根据配置信息进行重新渲染。整体逻辑就是围绕 JSON 配置文件的增删改，渲染引擎根据 JSON 来渲染。

逻辑上没有很复杂，复杂情况有 2 个地方，一个是组件增多的情况下属性面板的配置也是个麻烦活，十几个组件，每个组件的属性都会不太一样，因此属性面板也需要进行可配置，每个组件的可配置属性都需要一个 json 来配置，简单的一个`label`属性配置 scheme 如下：

```json
{
  "key": "label", // 标记属性字段
  "title": "标签", // 属性面板配置项名称
  "type": "string", //  值得类型，根据值得类型给出不同的属性配置组件(input,number,select)
  "value": "简单文本" // 属性的默认值
}
```

#### 面向的用户

这是表单引擎产品形态的决定性因素，这款产品的用户到底是谁，我们做出来后给谁用。这个将决定我们产品的形态以及各个组件的可配置属性。

我们产品面向的用户主要是业务人员，因此我们的组件设计要尽可能面向业务，而不是面向开发人员，组件在设计上也需要尽量的贴近业务，组件也不需要那么多的配置项属性，比如label的宽度、高度、是否可清空、是否可编辑代码等，这些属性我们可以部分内置，部分去掉；对于传统的24列栅格布局，大多数业务人员也并不了解，我们只需要做到一行2列，一行3列等这种简单易懂的形态。

用户群体决定了我们的产品形态，因此我们的组件尽量偏向业务，包含了一些常见的业务组件，比如部门、人员的选择、签批组件等，而在组件的配置项上也尽可能的精简，每个基本只保留4-5个可配置项。市面上较多的开源产品，它们大多可以复刻elementUI中表单组件的所有属性，然而，这是面向开发人员的，业务人员需要的是尽量少的配置和尽量多的业务组件。

一个项目面向的用户群体不同，做法也会大不一样，更多的了解产品，而不是只停留在代码上。